function getJSON(e,n){var o=new XMLHttpRequest;o.open("GET",e,!0),o.onload=function(){if(o.status>=200&&o.status<400){var e=JSON.parse(o.responseText);n(e,o)}},o.onerror=function(){},o.send()}function getData(){getJSON("http://ip-api.com/json",function(e){console.log(e),document.getElementById("ip").innerHTML=e.query,document.getElementById("country").innerHTML=e.countryCode+" / "+e.country,document.getElementById("isp").innerHTML=e.isp,createMap({lo:e.lon,la:e.lat,country:e.country}),getFlag(e.countryCode),getLocalIP(),browser.browserAction.setBadgeText({text:e.countryCode})})}function getFlag(e){document.getElementById("flag").src="http://www.geognos.com/api/en/countries/flag/"+e+".png"}function getLocalIP(){getIPs(function(e){console.log(e),document.getElementById("localIP").innerHTML=e||"No web rtc leaks!"})}function createMap(e){var n=document.getElementById("map");n.src="https://www.google.com/maps/embed/v1/view?key="+apiKey+"&center="+e.la+","+e.lo+"&zoom=8",n.onload=function(){console.log("map loaded")}}function getIPs(e){function n(n){var t=/([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7})/.exec(n)[1];void 0===o[t]&&e(t),o[t]=!0}var o={},t=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;window.webkitRTCPeerConnection;if(!t){var c=iframe.contentWindow;t=c.RTCPeerConnection||c.mozRTCPeerConnection||c.webkitRTCPeerConnection,!!c.webkitRTCPeerConnection}var i=new t({iceServers:[{urls:"stun:stun.services.mozilla.com"}]},{optional:[{RtpDataChannels:!0}]});i.onicecandidate=function(e){e.candidate&&n(e.candidate.candidate)},i.createDataChannel(""),i.createOffer(function(e){i.setLocalDescription(e,function(){},function(){})},function(){}),setTimeout(function(){i.localDescription.sdp.split("\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n(e)})},5e3)}var apiKey="AIzaSyAjVDotm8EmgZNby4xSEDxcf5oHh4OmNik";window.browser=window.msBrowser||window.browser||window.chrome,getData();